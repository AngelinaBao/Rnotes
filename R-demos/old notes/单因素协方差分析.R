-data(litter, package = "multcomp")
head(litter)
attach(litter)
table(dose) #0?????????????????????
aggregate(weight, by = list(dose), FUN = mean) #????????????????????????????????????
colnames(litter)
fit <- aov(weight ~ gesttime + dose)
summary(fit) #ANOVA???F????????????:???????????????????????????????????????;??????????????????,??????
#???????????????????????????
#????????????????????????,????????????????????????????????????,???????????????????????????????????????
library(effects)
effect("dose", fit) #??????????????????aggregate?????????????????????????????????
#?????????F?????????????????????????????????????????????????????????????????????,??????????????????????????????
#???????????????????????????
#??????????????????????????????,????????????multcomp????????????????????????????????????
#multcomp??????????????????????????????????????????????????????
#?????????????????????????????????????????????????????????????????????????????????
library(multcomp)
contrast <- rbind("no drug vs .drug" = c(3, -1, -1, -1))
#??????c(3,-1,-1,-1)???????????????????????????????????????????????????
summary(glht(fit, linfct = mcp(dose = contrast)))
#???????????????t???(2.581)???p<0.05???????????????,????????????????????????????????????????????????????????????

#????????????,ANCOVA??????????????????????????????????????????????????????
#???????????????
library(car)
qqPlot(lm(weight ~ gesttime + dose, data = litter), simulate = T,
       main = "Q-Q Plot")
#????????????95%???????????????,???????????????????????????
#ANOVA????????????????????????*?????????????????????,??????????????????????????????????????????
library(multcomp)
fit2 <- aov(weight ~ gesttime * dose, data = litter)
summary(fit2)
#gesttime???dose?????????????????????(p>0.1),??????gesttime??????????????????????????????dose???????????????
#?????????????????????,?????????????????????????????????
#????????????????????????????????????,????????????????????????????????????????????????????????????ANOVA??????,
#sm?????????sm.anova()???????????????????????????

#???????????????
#HH?????????ancova()????????????????????????????????????????????????????????????
library(HH)
ancova(weight ~ gesttime + dose, data = litter)
#????????????,????????????????????????????????????????????????????????????,??????????????????,???????????????
#??????????????????????????????,0???????????????????????????,5???????????????????????????
#??????ancova(weight ~ gesttime*dose),?????????????????????????????????????????????????????????
#????????????,?????????????????????????????????????????????????????????????????????
ancova(weight ~ gesttime*dose, data = litter) #?????????????????????????????????
detach(litter)