-rm(list = ls())
gc()
#?????????????????????
library(multcomp)
data(cholesterol, package = "multcomp")
attach(cholesterol)
head(cholesterol)
table(cholesterol)
class(cholesterol)
table(trt)
aggregate(response, by = list(trt), FUN = mean)
aggregate(response, by = list(trt), FUN = sd)
fit <- aov(response ~ trt)
summary(fit)
library(gplots)
plotmeans(response ~ trt, xlab = "Treatment", ylab = "Response",
          main = "Mean Plot \nwith 95% CI")
detach(cholesterol)
#??????????????????
#Method 1
TukeyHSD(fit)
par(las = 2) #??????????????????
par(mar = c(5,8,4,2)) #????????????
plot(TukeyHSD(fit))
#Method 2
library(multcomp)
par(mar = c(5,4,6,2))
tuk <- glht(fit, linfct = mcp(trt = "Tukey"))
plot(cld(tuk, .05), col = "lightgrey") #cld??????????????????
#??????????????????????????????????????????,1time???2times???????????????,1time???4times????????????
#????????????
#???????????????
library(car)
qqPlot(lm(response ~ trt, data = cholesterol), simulate = T, main = "QQ Plot")
#???simulate=TRUE???, 95%?????????????????????????????????????????????
#qqPlot??????lm()??????
#????????????95%??????????????????,???????????????????????????
#??????????????????
bartlett.test(response ~ trt, data = cholesterol)
#p=0.9653 ???????????????????????????????????????
#????????????????????????????????????,????????????????????????????????????
outlierTest(fit)
#??????????????????????????????(p>1?????????NA)
#??????,??????Q-Q??????bartleet???outlierTest???????????????,??????????????????ANOVA????????????
#?????????